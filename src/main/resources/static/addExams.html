<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>添加试题</title>
    <link rel="stylesheet" href="bootstrap-3.3.7/dist/css/bootstrap.css">
    <script src="js/jquery-2.1.4.js"></script>
    <script src="bootstrap-3.3.7/dist/js/bootstrap.js"></script>
    <link rel="stylesheet" href="bootstrap-3.3.7/bootstrap-select.css">
    <script src="bootstrap-3.3.7/bootstrap-select.js"></script>
    <style>
        #add{
            width: 300px;
            height: 600px;
            margin: 0 auto;
        }
        #submit{
            margin-top: 10px;
            margin-left: 80px;
        }
    </style>
    <script src="layer/layer.js"></script>
    <link rel="stylesheet" href="layer/theme/default/layer.css">
</head>
<body>
    <div id="add">
        <!--试题科目列表是有教师所教授的科目列表-->
        试题科目：<select class="selectpicker" title="请选择试题科目" id="title">
                    <option data-content="<span class='label label-success'>数学</span>">数学</option>
                </select>
        试题模块：<select class="selectpicker" title="请选择试题模块" id="leixing">
                    <option value="sss">选择题</option>
                    <option value="填空题">填空题</option>
                    <option value="判断题">判断题</option>
                    <option value="主观题">主观题</option>
                 </select>
        <div id="selects">
            题目:<br><textarea style="width:298px;height: 100px;"></textarea><br>
            A选项：<div class="input-group">
                    <input type="text" class="form-control" placeholder="A选项答案" size="298px" name="a">
                   </div>
            B选项： <div class="input-group">
                    <input type="text" class="form-control" placeholder="B选项答案" size="298px" name="b">
                   </div>
            C选项： <div class="input-group">
                    <input type="text" class="form-control" placeholder="C选项答案" size="298px" name="c">
                   </div>
            D选项： <div class="input-group">
                    <input type="text" class="form-control" placeholder="D选项答案" size="298px" name="d">
                   </div>
            正确答案：   <div class="input-group">
                        <input type="text" class="form-control" placeholder="正确答案" size="298px" name="y">
                    </div>
        </div>
        <div id="blanks" style="display: none;">
            题目：<textarea style="width: 298px;height: 100px;margin-top: 10px;"></textarea><br>
            答案：<div class="input-group">
                    <input type="text" class="form-control" placeholder="正确答案" size="298px" name="answer">
                </div>
        </div>
        <div id="submit">
            <button type="button" class="btn btn-primary" data-toggle="button" name="submit"> 提交</button>
            <button type="button" class="btn" data-toggle="button" name="back"> 返回</button>
        </div>

    </div>
</body>
<script>
    $(function () {
        var tid ;
        $.ajax({
            url: 'teacher/getTeacherSession',
            dataype: 'json',
            data: {"teacherBean": "teacherSession"},
            type: 'post',
            success: function (ret) {
                tid = ret.tid;
                $node = $('<option data-content="<span class=\'label label-success\'>'+ret.tmajor+'</span>">'+ret.tmajor+'</option>')
                $("#title").append($node);
            }
        })

        // 切换试题题目和答案
        $("#leixing").change(function () {
            var s1 = $("#leixing option:selected").val();
            if(s1=="填空题"){
                $("#blanks").show();
                $("#selects").hide();
            }else{
                $("#selects").show();
                $("#blanks").hide();
            }
        })

        $("button[name='submit']").click(function () {
            var s1 = $("#leixing option:selected").val();
            console.log(s1)
            if(s1=="填空题") {
                var leixing = $("select[title='请选择试题模块']").val();
                var question = $("#blanks textarea").val();
                var answer = $("input[name='answer']").val();
                $.ajax({
                    url:'blank/inserBlank',
                    dataType:'json',
                    type:'post',
                    data:{"blankquestion":question,
                        "blankanswer":answer,
                    "tid":tid},
                    success:function (ret) {
                        if(ret==1){
                            layer.msg("添加成功",{time:2000})
                        }else{
                            layer.ms("添加失败",{time:2000})
                        }

                    }
                })
            }
            if(s1=="选择题"){
                var title = $("select[title='请选择试题科目']").val();
                var leixing = $("select[title='请选择试题模块']").val();
                var question = $("#selects textarea").val();
                var a = $("input[name='a']").val();
                var b = $("input[name='b']").val();
                var c = $("input[name='c']").val();
                var d = $("input[name='d']").val();
                var y = $("input[name='y']").val();

                console.log(a+b+c+d+y);
                $.ajax({
                    url:'select/insertselect',
                    dataType:'json',
                    type:'post',
                    data:{"selectname":title,
                        "question":question,
                        "a":a,
                        "b":b,
                        "c":c,
                        "d":d,
                        "answer":y,
                        "tid":tid},
                    success:function (ret) {
                        if(ret==1){
                            layer.msg("添加成功",{time:2000})
                            $("input[name='a']").val("");
                            $("input[name='b']").val("");
                            $("input[name='c']").val("");
                            $("input[name='d']").val("");
                            $("input[name='y']").val("");
                            $("#selects textarea").val("");;
                        }else{
                            layer.ms("添加失败",{time:2000})
                        }

                    }
                })


            }

        })

        $("button[name='back']").click(function () {
            history.back();
        })






    })
</script>
</html>